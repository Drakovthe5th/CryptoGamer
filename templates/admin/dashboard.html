<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="/static/css/admin.css">
    <script src="/static/js/charts.js"></script>
    <script src="/static/js/admin.js"></script>
    <script src="/static/js/blockchain.js"></script>
    <script src="/static/js/monitoring.js"></script>
    <div id="frame" style="display: none; width: 100%;">
        <iframe data-aa='2405512' src='//acceptable.a-ads.com/2405512' style='border:0px; padding:0; width:100%; height:100%; overflow:hidden; background-color: transparent;'></iframe>
        <a style="display: block; text-align: right; font-size: 12px" id="frame-link" href="https://aads.com/campaigns/new/?source_id=2405512&source_type=ad_unit&partner=2405512">Advertise here</a>
    </div>
    
    <!-- Monetag Integration -->
    <script src='//libtl.com/sdk.js' data-zone='9644715' data-sdk='show_9644715'></script>
</head>
<body>
    <div class="admin-container">
        <h1>üìä Admin Dashboard</h1>
        
        <div class="stats">
            <!-- ... existing stats ... -->
        </div>
        
        <!-- Fraud Detection Section -->
        <h2>üõ°Ô∏è Fraud Detection</h2>
        <div class="fraud-stats">
            <div class="stat-card">
                <h3>Pending Reviews</h3>
                <p id="pending-reviews">12</p>
            </div>
            <div class="stat-card">
                <h3>Flagged Today</h3>
                <p id="flagged-today">5</p>
            </div>
            <div class="stat-card">
                <h3>High Risk</h3>
                <p id="high-risk">3</p>
            </div>
        </div>
        <table class="fraud-table" id="fraud-table">
            <thead>
                <tr>
                    <th>User</th>
                    <th>Activity</th>
                    <th>Risk Level</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>user_1234</td>
                    <td>Multiple withdrawals in 1h</td>
                    <td class="risk-high">High</td>
                    <td><button class="action-btn btn-review">Review</button></td>
                </tr>
                <!-- More rows will be loaded dynamically -->
            </tbody>
        </table>
        
        <!-- Blockchain Dashboard -->
        <h2>üîó Blockchain Operations</h2>
        <div class="blockchain-stats">
            <div class="blockchain-card">
                <h3>TON Staking Contracts</h3>
                <p>Active: <span id="staking-active">42</span></p>
                <p>Total Staked: <span id="staking-total">1,240 TON</span></p>
            </div>
            <div class="blockchain-card">
                <h3>Token Swaps</h3>
                <p>Today: <span id="swaps-today">18</span></p>
                <p>Volume: <span id="swap-volume">560 TON</span></p>
            </div>
            <div class="blockchain-card">
                <h3>Cross-Chain</h3>
                <p>ETH Bridges: <span id="eth-bridges">3</span></p>
                <p>BNB Bridges: <span id="bnb-bridges">2</span></p>
            </div>
        </div>
        
        <!-- Infrastructure Monitoring -->
        <h2>‚öôÔ∏è Infrastructure Monitoring</h2>
        <div class="monitoring-grid">
            <div class="monitor-card">
                <h3>Server Load</h3>
                <div class="status-indicator status-up"></div>
                <div class="metric-value">24%</div>
                <div>CPU: 24% | RAM: 58%</div>
            </div>
            <div class="monitor-card">
                <h3>TON Node</h3>
                <div class="status-indicator status-up"></div>
                <div class="metric-value">Online</div>
                <div>Block: 3,248,192</div>
            </div>
            <div class="monitor-card">
                <h3>Database</h3>
                <div class="status-indicator status-warning"></div>
                <div class="metric-value">72%</div>
                <div>Queries: 42/s</div>
            </div>
            <div class="monitor-card">
                <h3>Payment Gateways</h3>
                <div class="status-indicator status-up"></div>
                <div class="metric-value">Operational</div>
                <div>MPesa, PayPal, Bank</div>
            </div>
        </div>
        
        <div class="loadtest-section">
            <h2>üìà Load Testing</h2>
            <button id="run-loadtest">Run Load Test</button>
            <div id="loadtest-results"></div>
        </div>
        
        <!-- ... existing charts ... -->
    </div>
    
    <script>
        // Initialize blockchain data
        fetch('/api/blockchain/stats')
            .then(response => response.json())
            .then(data => {
                document.getElementById('staking-active').textContent = data.staking.active;
                document.getElementById('staking-total').textContent = data.staking.total;
                document.getElementById('swaps-today').textContent = data.swaps.count;
                document.getElementById('swap-volume').textContent = data.swaps.volume;
                document.getElementById('eth-bridges').textContent = data.bridges.eth;
                document.getElementById('bnb-bridges').textContent = data.bridges.bnb;
            });
        
        // Load fraud data
        fetch('/api/fraud/data')
            .then(response => response.json())
            .then(data => {
                document.getElementById('pending-reviews').textContent = data.pending;
                document.getElementById('flagged-today').textContent = data.flagged;
                document.getElementById('high-risk').textContent = data.high_risk;
                
                // Populate fraud table
                const table = document.getElementById('fraud-table');
                data.entries.forEach(entry => {
                    const row = table.insertRow();
                    row.insertCell(0).textContent = entry.user;
                    row.insertCell(1).textContent = entry.activity;
                    const riskCell = row.insertCell(2);
                    riskCell.textContent = entry.risk;
                    riskCell.classList.add(`risk-${entry.risk.toLowerCase()}`);
                    
                    const actionCell = row.insertCell(3);
                    const btn = document.createElement('button');
                    btn.className = 'action-btn btn-review';
                    btn.textContent = 'Review';
                    btn.onclick = () => reviewFraudCase(entry.id);
                    actionCell.appendChild(btn);
                });
            });
        
        // Run load test
        document.getElementById('run-loadtest').addEventListener('click', () => {
            const config = {
                users: 1000,
                duration: 300 // 5 minutes
            };
            
            fetch('/api/loadtest', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(config)
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('loadtest-results').textContent = 
                    `Load test started. Test ID: ${data.test_id}`;
            });
        });
    </script>
</body>
</html>