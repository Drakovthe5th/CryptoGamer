<!-- Copyright (C) Microsoft Corporation. All rights reserved.
 Use of this source code is governed by a BSD-style license that can be
 found in the LICENSE file. -->

<!DOCTYPE html>
<!-- saved from url=edge://surf/ -->
<html dir="ltr" lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="apple-touch-icon" sizes="57x57" href="/games/static/egde-surf/resources/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/games/static/egde-surf/resources/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/games/static/egde-surf/resources/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/games/static/egde-surf/resources/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/games/static/egde-surf/resources/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/games/static/egde-surf/resources/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/games/static/egde-surf/resources/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/games/static/egde-surf/resources/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/games/static/egde-surf/resources/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/games/static/egde-surf/resources/icons/android-icon-192x192.png">
  <link rel="icon" type="image/svg+xml" href="/games/static/egde-surf/resources/icons/favicon.svg">
  <link rel="manifest" href="/games/static/egde-surf/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="resources/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <script>
    // Consolidated initialization logic
    document.addEventListener('DOMContentLoaded', () => {
      // Telegram WebApp check
      if (!window.Telegram || !window.Telegram.WebApp) {
        alert("Please open this game in Telegram");
        window.location.href = "https://t.me/Got3dBot";
        return;
      }
      
      Telegram.WebApp.ready();
      
      // Get user data from Telegram
      const userId = Telegram.WebApp.initDataUnsafe.user?.id;
      if (!userId) {
        console.error("User ID not available");
        return;
      }

        // Initialize Telegram Web Events
      if (window.TelegramWebEvents) {
        // Setup game-specific buttons and events
        window.TelegramWebEvents.setupMainButton(true, true, 'Play Now', '#3390ec', '#ffffff', false, true);
        
        // Share functionality
        window.shareScore = function(score) {
          window.TelegramWebEvents.shareScore(score, window.gameName);
        };
        
        window.shareGame = function() {
          window.TelegramWebEvents.shareGame(window.gameName);
        };
      }

      // Initialize game
      fetch('/api/game/edge-surf/init', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({user_id: userId})
      })
      .then(response => response.json())
      .then(data => {
        initGame(userId, data.token, data.game_config);
      })
      .catch(error => {
        console.error('Initialization error:', error);
      });
    });

    async function initGame(userId, token, gameConfig) {
      // Initialize game with user-specific data
      window.securityToken = token;
      window.userId = userId;
      window.gameConfig = gameConfig;
    }
  </script>

  <script>
    // Show ad when game starts
    document.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
            showRewardedAd('game_start_interstitial');
        }, 2000);
    });

    // Show ad when player achieves milestone
    function checkMilestone(score) {
        if (score % 100 === 0) {
            showRewardedAd('game_milestone_popup');
        }
    }
  </script>



  <script src="/games/static/egde-surf/resources/js/base-error-reporting.js"></script>
  <script src="/games/static/egde-surf/resources/js/surf-error-reporting.js"></script>
  <script src="/games/static/egde-surf/resources/js/assert.js"></script>
  <script src="/games/static/egde-surf/resources/js/promise_resolver.js"></script>
  <script src="/games/static/egde-surf/resources/js/cr.js"></script>
  <script src="/games/static/egde-surf/resources/js/parse_html_subset.js"></script>
  <script src="/games/static/egde-surf/resources/js/load_time_data.js"></script>
  <script src="/games/static/egde-surf/resources/js/util.js"></script>
  <script src="/games/static/egde-surf/resources/js/strings.js"></script>
  <link href="/games/static/egde-surf/resources/css/interface.css" rel="stylesheet" media="all"/>
</head>
<body>
  <div id="hamburger-container"></div>
  <div id="modal-root"></div>
  <script defer="defer" src="/games/static/egde-surf/resources/js/lib_react.chunk.js"></script>
  <script defer="defer" src="/games/static/egde-surf/resources/js/lib_common.chunk.js"></script>
  <script defer="defer" src="/games/static/egde-surf/resources/js/surf.bundle.js"></script>

  <button class="btn btn-secondary" onclick="resetGame('trivia')">
    ðŸ”„ Reset (3 left)
  </button>

  <div class="share-buttons">
      <button onclick="shareScore()">Share Score</button>
      <button onclick="shareGame()">Share Game</button>
  </div>

</body>
</html>